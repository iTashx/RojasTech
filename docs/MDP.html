<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MDP - Manual de Desarrollo Privado</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="/RojasTech/css/MDP.css">
</head>
<body>
    <div class="mdp-container">
        <div class="mdp-card">
            <div class="mdp-header">
                <h1><i class="fas fa-book me-2"></i>Manual de Desarrollo Privado</h1>
                <p class="text-muted">SIGESCON - Documentación Técnica</p>
            </div>

            <!-- Formulario de Login -->
            <div id="mdp-login">
                <form id="mdp-login-form" class="mdp-form">
                    <div class="mb-3">
                        <label for="mdp-username" class="form-label">Usuario</label>
                        <input type="text" class="form-control" id="mdp-username" name="mdp-username" required>
                    </div>
                    <div class="mb-3">
                        <label for="mdp-password" class="form-label">Contraseña</label>
                        <input type="password" class="form-control" id="mdp-password" name="mdp-password" required>
                    </div>
                    <button type="submit" class="btn btn-primary w-100">
                        <i class="fas fa-sign-in-alt me-2"></i>Ingresar
                    </button>
                </form>
                <div id="mdp-error" class="alert alert-danger mdp-alert"></div>
            </div>

            <!-- Contenido del MDP -->
            <div id="mdp-content" style="display: none;">
                <div class="mdp-admin-section">
                    <h3><i class="fas fa-cog me-2"></i>Administración de Credenciales</h3>
                    <form id="mdp-admin-form" class="mdp-form">
                        <div class="mb-3">
                            <label for="new-username" class="form-label">Nuevo Usuario</label>
                            <input type="text" class="form-control" id="new-username" required>
                        </div>
                        <div class="mb-3">
                            <label for="new-password" class="form-label">Nueva Contraseña</label>
                            <input type="password" class="form-control" id="new-password" required>
                        </div>
                        <div class="mb-3">
                            <label for="confirm-password" class="form-label">Confirmar Contraseña</label>
                            <input type="password" class="form-control" id="confirm-password" required>
                        </div>
                        <button type="submit" class="btn btn-success w-100">
                            <i class="fas fa-save me-2"></i>Actualizar Credenciales
                        </button>
                    </form>
                    <div id="mdp-success" class="alert alert-success mdp-alert"></div>
                </div>

                <!-- Contenido de la documentación -->
                <div class="mdp-documentation">
                    # Manual de Desarrollo Privado (MDP) - SIGESCON

## Índice
1. [Estructura del Proyecto](#estructura-del-proyecto)
2. [Arquitectura](#arquitectura)
3. [Base de Datos](#base-de-datos)
4. [Interfaz de Usuario](#interfaz-de-usuario)
5. [Lógica de Negocio](#lógica-de-negocio)
6. [Seguridad](#seguridad)
7. [Optimización](#optimización)
8. [Mantenimiento](#mantenimiento)

## Estructura del Proyecto

```
SIGESCON/
├── index.html              # Página principal
├── ayuda.html             # Documentación usuario
├── css/
│   ├── style.css         # Estilos generales
│   ├── ayuda.css         # Estilos ayuda
│   └── MDP.css           # Estilos documentación privada
├── js/
│   ├── script.js         # Lógica principal
│   ├── db.js            # Manejo de IndexedDB
│   ├── ui.js            # Componentes UI
│   ├── calculations.js  # Funciones de cálculo
│   ├── validations.js   # Validaciones
│   ├── exports.js       # Exportación de datos
│   └── MDP.js           # Lógica documentación privada
├── docs/
│   ├── MDP.md           # Este archivo
│   └── personal.md      # Documentación técnica general
└── assets/
    ├── images/          # Imágenes del proyecto
    └── icons/           # Iconos personalizados
```

## Arquitectura

### Patrones de Diseño
- **MVC (Modelo-Vista-Controlador)**
  - Modelo: IndexedDB (Dexie.js)
  - Vista: HTML/CSS
  - Controlador: JavaScript

- **Singleton**
  - Instancia única de la base de datos
  - Gestor de eventos globales

- **Observer**
  - Actualización de UI en tiempo real
  - Notificaciones de cambios

### Flujo de Datos
```mermaid
graph TD
    A[UI] -->|Eventos| B[Controlador]
    B -->|Operaciones| C[Modelo DB]
    C -->|Actualizaciones| D[Observer]
    D -->|Notificaciones| A
```

## Base de Datos

### Esquema IndexedDB

#### Tabla: Contratos
```javascript
{
    id: number,                    // Clave primaria
    numeroProveedor: string,       // Identificador único
    fechaFirma: Date,             // Fecha de firma
    fechaInicio: Date,            // Fecha de inicio
    fechaTerminacion: Date,       // Fecha de terminación
    montoTotal: number,           // Monto total del contrato
    estatus: string,              // Estado actual
    modalidad: string,            // Modalidad de contratación
    moneda: string,               // Tipo de moneda
    observaciones: string,        // Notas adicionales
    archivos: Array<File>,        // Archivos adjuntos
    fechaCreacion: Date,          // Fecha de creación
    fechaModificacion: Date,      // Última modificación
    usuarioCreacion: string,      // Usuario que creó
    usuarioModificacion: string   // Último usuario que modificó
}
```

#### Tabla: Partidas
```javascript
{
    id: number,                    // Clave primaria
    contratoId: number,           // Referencia a Contratos
    descripcion: string,          // Descripción detallada
    cantidad: number,             // Cantidad contratada
    umd: string,                  // Unidad de medida
    precioUnitario: number,       // Precio por unidad
    total: number,                // Total calculado
    fechaCreacion: Date,          // Fecha de creación
    fechaModificacion: Date       // Última modificación
}
```

#### Tabla: HES
```javascript
{
    id: number,                    // Clave primaria
    contratoId: number,           // Referencia a Contratos
    numeroHES: string,            // Número de HES
    fechaInicio: Date,            // Fecha de inicio
    fechaFinal: Date,             // Fecha final
    total: number,                // Monto total
    estatus: string,              // Estado actual
    aprobado: boolean,            // Estado de aprobación
    fechaAprobacion: Date,        // Fecha de aprobación
    archivos: Array<File>,        // Documentos adjuntos
    fechaCreacion: Date,          // Fecha de creación
    fechaModificacion: Date       // Última modificación
}
```

#### Tabla: PartidasHES
```javascript
{
    id: number,                    // Clave primaria
    hesId: number,                // Referencia a HES
    partidaId: number,            // Referencia a Partidas
    cantidadEjecutada: number,    // Cantidad ejecutada
    totalPartida: number,         // Total calculado
    fechaCreacion: Date,          // Fecha de creación
    fechaModificacion: Date       // Última modificación
}
```

### Índices y Relaciones
```javascript
// Índices principales
db.contratos.index('numeroProveedor');
db.contratos.index('estatus');
db.hes.index('contratoId');
db.partidas.index('contratoId');
db.partidasHES.index('hesId');
db.partidasHES.index('partidaId');

// Relaciones
db.contratos.hasMany('partidas');
db.contratos.hasMany('hes');
db.hes.hasMany('partidasHES');
db.partidas.hasMany('partidasHES');
```

## Interfaz de Usuario

### Componentes Principales

#### 1. Header
```html
<header class="header bg-light-blue">
    <div class="container-fluid">
        <div class="d-flex justify-content-between align-items-center py-3">
            <div class="logo d-flex align-items-center">
                <i class="fas fa-file-contract me-2"></i>
                <h1 class="mb-0">Gestión de Contratos Empresariales</h1>
            </div>
            <a href="ayuda.html" target="_blank" class="btn btn-primary help-btn">
                <i class="fas fa-question-circle me-2"></i> Ayuda
            </a>
        </div>
    </div>
</header>
```

#### 2. Sidebar
```html
<aside class="sidebar bg-dark-blue">
    <nav class="nav flex-column">
        <!-- Botones de navegación -->
    </nav>
</aside>
```

#### 3. Contenido Principal
```html
<main class="content">
    <section id="[section-id]" class="content-section">
        <!-- Contenido dinámico -->
    </section>
</main>
```

### Estilos CSS

#### Variables Globales
```css
:root {
    --primary-color: #4CAF50;
    --secondary-color: #2196F3;
    --accent-color: #FFC107;
    --danger-color: #F44336;
    --success-color: #4CAF50;
    --info-color: #03A9F4;
    --background-color: #f0f2f5;
    --card-background: #ffffff;
    --text-color: #333;
    --light-text-color: #666;
    --border-color: #ddd;
    --header-bg: #3f51b5;
}
```

#### Layout
```css
.main-container {
    display: grid;
    grid-template-columns: 250px 1fr;
    min-height: 100vh;
}

.content {
    padding: 20px;
    overflow-y: auto;
}
```

#### Componentes
```css
.card {
    background: var(--card-background);
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    padding: 20px;
    margin-bottom: 20px;
}

.table-responsive {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
}
```

## Lógica de Negocio

### Gestión de Contratos

#### Creación de Contrato
```javascript
async function crearContrato(datos) {
    try {
        // Validaciones
        validarDatosContrato(datos);
```
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/RojasTech/js/MDP.js"></script>
</body>
</html> 