<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIGESCON - Gestión de Contratos Empresariales</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <style>
        /* Variables CSS (opcional, pero buena práctica) */
        :root {
            --primary-color: #007bff; /* Azul Bootstrap por defecto */
            --secondary-color: #6c757d;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --info-color: #17a2b8;
            --warning-color: #ffc107;

            /* Nuevos colores para la interfaz */
            --light-blue-header: #91B8E5; /* Un azul claro */
            --dark-blue-sidebar: #4682B4; /* Un tono de azul más oscuro para el sidebar */
            --sidebar-text-color: #ffffff; /* Texto blanco para el sidebar */
            --sidebar-active-bg: #6BA8DB; /* Color de fondo para botón activo en sidebar */
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f7f6; /* Fondo más claro */
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .header {
            background-color: var(--light-blue-header); /* Aplicando el nuevo color */
            color: white;
            padding: 10px 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .header .logo h1 {
            font-size: 1.8rem;
            font-weight: 600;
        }

        .main-container {
            display: flex;
            flex: 1; /* Permite que el contenedor principal ocupe el espacio restante */
        }

        .sidebar {
            width: 250px;
            background-color: var(--dark-blue-sidebar); /* Aplicando el nuevo color */
            color: var(--sidebar-text-color); /* Color de texto para el sidebar */
            padding: 20px 0;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
            flex-shrink: 0; /* Evita que el sidebar se encoja */
        }

        .sidebar .nav-link {
            color: var(--sidebar-text-color);
            padding: 12px 20px;
            display: flex;
            align-items: center;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .sidebar .nav-link:hover,
        .sidebar .nav-link.active {
            background-color: var(--sidebar-active-bg); /* Color de fondo para activo/hover */
            color: #fff;
            border-left: 5px solid var(--primary-color);
            padding-left: 15px; /* Ajuste para el borde */
        }

        .sidebar .nav-link i {
            margin-right: 10px;
            font-size: 1.1rem;
        }

        .content {
            flex-grow: 1; /* Permite que el contenido ocupe el espacio restante */
            padding: 20px;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
            margin: 20px; /* Margen alrededor del contenido principal */
            border-radius: 8px;
        }

        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
        }

        h2 {
            color: #333;
            margin-bottom: 25px;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
        }

        h2 i {
            margin-right: 10px;
            color: var(--primary-color);
        }

        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .summary-cards .card {
            background-color: #ffffff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            text-align: center;
            border-left: 5px solid var(--primary-color);
        }

        .summary-cards .card h3 {
            font-size: 1.2rem;
            color: #555;
            margin-bottom: 10px;
        }

        .summary-cards .card p {
            font-size: 2.2rem;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 0;
        }

        /* Formularios y controles */
        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            font-weight: 500;
            color: #444;
            margin-bottom: 5px;
            display: block;
        }

        .form-control, .form-select {
            border-radius: 5px;
            border: 1px solid #ddd;
            padding: 8px 12px;
            font-size: 0.95rem;
            width: 100%; /* Asegura que ocupen todo el ancho disponible */
        }

        .contract-form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .contract-form-grid .col-span-2 {
            grid-column: span 2;
        }

        /* Tablas */
        .table {
            width: 100%;
            margin-top: 20px;
            border-collapse: collapse;
        }

        .table th, .table td {
            padding: 10px 15px;
            border: 1px solid #e9ecef;
            text-align: left;
            vertical-align: middle;
        }

        .table thead th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: #495057;
            border-bottom: 2px solid #dee2e6;
        }

        .table-hover tbody tr:hover {
            background-color: #f1f1f1;
        }

        .table-striped tbody tr:nth-of-type(odd) {
            background-color: #fdfdfd;
        }

        .btn {
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .btn i {
            margin-right: 5px;
        }

        .btn-primary { background-color: var(--primary-color); border-color: var(--primary-color); color: white; }
        .btn-primary:hover { background-color: #0056b3; border-color: #0056b3; }
        .btn-secondary { background-color: var(--secondary-color); border-color: var(--secondary-color); color: white; }
        .btn-secondary:hover { background-color: #5a6268; border-color: #545b62; }
        .btn-success { background-color: var(--success-color); border-color: var(--success-color); color: white; }
        .btn-success:hover { background-color: #218838; border-color: #1e7e34; }
        .btn-danger { background-color: var(--danger-color); border-color: var(--danger-color); color: white; }
        .btn-danger:hover { background-color: #c82333; border-color: #bd2130; }
        .btn-info { background-color: var(--info-color); border-color: var(--info-color); color: white; }
        .btn-info:hover { background-color: #138496; border-color: #117a8b; }
        .btn-warning { background-color: var(--warning-color); border-color: var(--warning-color); color: #212529; }
        .btn-warning:hover { background-color: #e0a800; border-color: #d39e00; }

        .btn-sm {
            padding: 5px 10px;
            font-size: 0.8rem;
        }

        .button-group button {
            min-width: 150px; /* Ancho mínimo para los botones de acción */
        }

        /* Contenedor de Toast */
        #toast-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1050; /* Por encima de la mayoría de los elementos */
            display: flex; /* Asegura que los toasts se apilen verticalmente */
            flex-direction: column;
            gap: 10px; /* Espacio entre toasts */
        }

        .toast-message { /* Renombrado de .toast a .toast-message para evitar conflicto con Bootstrap */
            background-color: #333;
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            margin-bottom: 0; /* Eliminado margin-bottom para usar gap en el contenedor */
            opacity: 0.9;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            animation: fadeInOut 3s forwards;
        }

        .toast-message.success { background-color: #28a745; }
        .toast-message.error { background-color: #dc3545; }
        .toast-message.warning { background-color: #ffc107; color: #333; }
        .toast-message.info { background-color: #17a2b8; }

        @keyframes fadeInOut {
            0% { opacity: 0; transform: translateY(20px); }
            10% { opacity: 0.9; transform: translateY(0); }
            90% { opacity: 0.9; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(20px); }
        }


        /* Filtros */
        .filter-container {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #e9ecef;
            align-items: flex-end; /* Alinea los botones con los inputs */
        }

        .filter-group {
            flex: 1;
            min-width: 200px;
        }

        .filter-buttons {
            display: flex;
            gap: 10px;
        }

        /* Exportación */
        .export-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: flex-end; /* Alinea a la derecha */
        }

        /* Footer (no presente en el HTML actual, pero mantenido por si acaso) */
        .footer {
            background-color: #343a40;
            color: white;
            padding: 15px 0;
            font-size: 0.9rem;
            box-shadow: 0 -2px 4px rgba(0, 0, 0, 0.1);
            margin-top: auto; /* Empuja el footer hacia abajo */
        }

        .footer a {
            color: #17a2b8;
            text-decoration: none;
        }

        .footer a:hover {
            text-decoration: underline;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .main-container {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                padding: 10px 0;
                box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            }

            .sidebar .nav {
                flex-direction: row;
                overflow-x: auto; /* Permite scroll horizontal para botones */
                white-space: nowrap;
                justify-content: space-between;
            }

            .sidebar .nav-link {
                padding: 10px;
                font-size: 0.85rem;
                flex-shrink: 0; /* Evita que los botones se encojan demasiado */
                text-align: center;
                flex-direction: column; /* Icono arriba, texto abajo */
            }

            .sidebar .nav-link i {
                margin-right: 0;
                margin-bottom: 5px;
            }

            .sidebar .nav-link.active {
                border-left: none;
                border-bottom: 3px solid var(--primary-color);
                padding-left: 10px; /* Restablecer padding-left */
            }

            .content {
                margin: 10px;
                padding: 15px;
            }

            .header .logo h1 {
                font-size: 1.5rem;
            }

            .summary-cards {
                grid-template-columns: 1fr;
            }

            .contract-form-grid {
                grid-template-columns: 1fr;
            }

            .contract-form-grid .col-span-2 {
                grid-column: span 1;
            }

            .filter-container {
                flex-direction: column;
                align-items: stretch;
            }

            .filter-buttons {
                flex-direction: column;
                gap: 5px;
            }
            
            .export-buttons {
                flex-direction: column;
                gap: 5px;
            }
        }

        /* Mejora de la tabla de partidas del contrato y HES */
        .table-responsive {
            overflow-x: auto; /* Asegura el scroll horizontal si la tabla es muy ancha */
            margin-bottom: 20px;
        }

        .contract-list-table,
        #hes-list-table,
        #deleted-contracts-table,
        #deleted-hes-table {
            min-width: 800px; /* Ancho mínimo para que no se vea tan apretada */
        }

        /* Estilos para barras de progreso (avance) */
        .progress {
            height: 20px; /* Altura de la barra de progreso */
            border-radius: 5px;
            background-color: #e9ecef;
        }

        .progress-bar {
            text-align: center;
            color: white;
            font-weight: bold;
            line-height: 20px; /* Centra el texto verticalmente */
            transition: width 0.6s ease;
        }

        /* Clases específicas para el color de las barras */
        .bg-light-blue {
            background-color: var(--light-blue-header) !important;
        }

        .bg-dark-blue {
            background-color: var(--dark-blue-sidebar) !important;
        }

        /* Para los switches de checkbox */
        .form-check.form-switch {
            display: flex;
            align-items: center;
        }
        .form-check-input {
            min-width: 3em; /* Ajuste para el switch */
            height: 1.5em; /* Ajuste para el switch */
            margin-right: 0.5rem;
        }
    </style>
</head>
<body>
    <header class="header bg-light-blue">
        <div class="container-fluid">
            <div class="d-flex justify-content-between align-items-center py-3">
                <div class="logo d-flex align-items-center">
                    <i class="fas fa-file-contract me-2"></i>
                    <h1 class="mb-0">Gestión de Contratos Empresariales</h1>
                </div>
                <a href="ayuda.html" target="_blank" class="btn btn-primary help-btn">
                    <i class="fas fa-question-circle me-2"></i> Ayuda
                </a>
            </div>
        </div>
    </header>

    <div class="main-container">
        <aside class="sidebar bg-dark-blue">
            <nav class="nav flex-column">
                <button class="nav-link tab-btn active" data-target="general-summary">
                    <i class="fas fa-tachometer-alt me-2"></i> Resumen General
                </button>
                <button class="nav-link tab-btn" data-target="new-edit-contract">
                    <i class="fas fa-file-contract me-2"></i> Nuevo/Editar Contrato
                </button>
                <button class="nav-link tab-btn" data-target="contract-list">
                    <i class="fas fa-list me-2"></i> Lista de Contratos
                </button>
                <button class="nav-link tab-btn" data-target="hes-management">
                    <i class="fas fa-clipboard-list me-2"></i> Gestión de HES
                </button>
                <button class="nav-link tab-btn" data-target="physical-advance">
                    <i class="fas fa-chart-line me-2"></i> Avance Físico
                </button>
                <button class="nav-link tab-btn" data-target="financial-advance">
                    <i class="fas fa-dollar-sign me-2"></i> Avance Financiero
                </button>
                <button class="nav-link tab-btn" data-target="graphic-summary">
                    <i class="fas fa-chart-bar me-2"></i> Resumen Gráfico
                </button>
                <button class="nav-link tab-btn" data-target="reports">
                    <i class="fas fa-file-alt me-2"></i> Informes
                </button>
                <button class="nav-link tab-btn" data-target="trash-can">
                    <i class="fas fa-trash-alt me-2"></i> Papelera de Reciclaje
                </button>
            </nav>
        </aside>

        <main class="content">
            <section id="general-summary" class="content-section active">
                <h2><i class="fas fa-tachometer-alt me-2"></i> Resumen General</h2>
                <div class="summary-cards">
                    <div class="card">
                        <h3>Contratos Activos</h3>
                        <p id="active-contracts">0</p>
                    </div>
                    <div class="card">
                        <h3>Monto Total Contratado</h3>
                        <p id="total-contract-amount">USD 0.00</p>
                    </div>
                    <div class="card">
                        <h3>Contratos por Vencer (30 días)</h3>
                        <p id="expiring-contracts">0</p>
                    </div>
                    <div class="card">
                        <h3>Total Modalidades</h3>
                        <p id="total-modalities">0</p>
                    </div>
                </div>
            </section>

            <section id="new-edit-contract" class="content-section">
                <h2><i class="fas fa-file-contract me-2"></i> Nuevo/Editar Contrato</h2>
                <form id="contract-form" class="g-3">
                    <div class="mb-4">
                        <label for="existing-contract-select" class="form-label">Seleccionar Contrato Existente para Editar:</label>
                        <div class="input-group">
                            <select id="existing-contract-select" class="form-select">
                                <option value="">-- Seleccione un Contrato --</option>
                            </select>
                            <button type="button" class="btn btn-info" id="load-contract-btn">
                                <i class="fas fa-file-import me-2"></i> Cargar Contrato
                            </button>
                        </div>
                        <small class="form-text text-muted">Seleccione un contrato para cargar sus datos y editarlos, o deje en blanco para crear uno nuevo.</small>
                    </div>
                    <div class="contract-form-grid">
                        <div class="form-group">
                            <label for="numero-proveedor">Número de Proveedor:</label>
                            <input type="text" id="numero-proveedor" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="fecha-firma-contrato">Fecha Firma del Contrato:</label>
                            <input type="date" id="fecha-firma-contrato" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="fecha-creado">Fecha Creado:</label>
                            <input type="date" id="fecha-creado" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="fecha-inicio">Fecha Inicio:</label>
                            <input type="date" id="fecha-inicio" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="fecha-terminacion">Fecha Terminación:</label>
                            <input type="date" id="fecha-terminacion" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="periodo-culminacion">Periodo Culminación (Días):</label>
                            <input type="number" id="periodo-culminacion" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="numero-sicac">N° Contrato SICAC:</label>
                            <input type="text" id="numero-sicac" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="division-area">División/Área:</label>
                            <input type="text" id="division-area" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="eemn">EEMN:</label>
                            <input type="text" id="eemn" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="region">Región:</label>
                            <input type="text" id="region" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="naturaleza-contratacion">Naturaleza de la Contratación:</label>
                            <input type="text" id="naturaleza-contratacion" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="linea-servicio">Línea de Servicio:</label>
                            <input type="text" id="linea-servicio" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="no-peticion-oferta">No. Petición de Oferta:</label>
                            <input type="text" id="no-peticion-oferta" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="modalidad-contratacion">Modalidad de Contratación:</label>
                            <div class="input-group">
                                <select id="modalidad-contratacion" class="form-select" required>
                                    <option value="">Selecciona una modalidad</option>
                                </select>
                                <button type="button" class="btn btn-primary" id="add-modalidad-btn"><i class="fas fa-plus"></i></button>
                                <button type="button" class="btn btn-danger" id="remove-modalidad-btn"><i class="fas fa-minus"></i></button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="regimen-laboral">Régimen Laboral:</label>
                            <input type="text" id="regimen-laboral" class="form-control">
                        </div>
                        <div class="form-group col-span-2">
                            <label for="objeto-contractual">Objeto Contractual / Descripción:</label>
                            <textarea id="objeto-contractual" class="form-control" rows="3"></textarea>
                            <button type="button" class="btn btn-info mt-2" id="generate-summary-btn">
                                <i class="fas fa-magic me-2"></i> Generar Resumen/Cláusulas Clave ✨
                            </button>
                        </div>
                        <div class="form-group col-span-2">
                            <label for="generated-summary">Resumen/Cláusulas Clave Generadas por IA:</label>
                            <textarea id="generated-summary" class="form-control" rows="5" readonly placeholder="El resumen y las cláusulas clave generadas por IA aparecerán aquí..."></textarea>
                            <div id="summary-loading-indicator" class="spinner-border spinner-border-sm text-primary mt-2" role="status" style="display:none;">
                                <span class="visually-hidden">Cargando...</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="fecha-cambio-alcance">Fecha Cambio Alcance:</label>
                            <input type="date" id="fecha-cambio-alcance" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="monto-original">Monto Original:</label>
                            <input type="number" id="monto-original" class="form-control" step="0.01" value="0.00" readonly>
                        </div>
                        <div class="form-group">
                            <label for="monto-modificado">Monto Modificado:</label>
                            <input type="number" id="monto-modificado" class="form-control" step="0.01" value="0.00">
                        </div>
                        <div class="form-group">
                            <label for="monto-total-contrato">Monto Total del Contrato:</label>
                            <input type="number" id="monto-total-contrato" class="form-control" step="0.01" value="0.00" readonly>
                        </div>
                        <div class="form-group">
                            <label for="numero-contrato-interno">No. Contrato (Interno):</label>
                            <input type="text" id="numero-contrato-interno" class="form-control">
                        </div>
                        <div class="form-group col-span-2">
                            <label for="observaciones">Observaciones:</label>
                            <textarea id="observaciones" class="form-control" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="estatus-contrato">Estatus:</label>
                            <select id="estatus-contrato" class="form-select">
                                <option value="Activo">Activo</option>
                                <option value="Inactivo">Inactivo</option>
                                <option value="Cerrado">Cerrado</option>
                                <option value="Suspendido">Suspendido</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="moneda">Moneda:</label>
                            <select id="moneda" class="form-select">
                                <option value="USD">USD</option>
                                <option value="EUR">EUR</option>
                                <option value="VES">VES</option>
                            </select>
                        </div>
                        <div class="form-group col-span-2">
                            <label for="adjuntar-archivos">Adjuntar Archivos:</label>
                            <input type="file" id="adjuntar-archivos" class="form-control" multiple>
                            <small class="text-muted" id="adjuntar-archivos-info">Ningún archivo seleccionado</small>
                        </div>
                    </div>

                    <h3 class="mt-4">Partidas del Contrato</h3>
                    <div class="d-flex justify-content-end mb-3">
                        <button type="button" class="btn btn-success" id="add-partida-btn">
                            <i class="fas fa-plus me-2"></i> Añadir Partida
                        </button>
                    </div>
                    <div class="table-responsive">
                        <table class="table table-bordered table-striped" id="partidas-table">
                            <thead>
                                <tr>
                                    <th>N°</th>
                                    <th>Descripción</th>
                                    <th>Cantidad</th>
                                    <th>UMD</th>
                                    <th>Precio Unitario</th>
                                    <th>Total</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody>
                                </tbody>
                        </table>
                    </div>
                    <div class="text-center mt-4 button-group">
                        <button type="submit" class="btn btn-primary" id="save-contract-btn">
                            <i class="fas fa-save me-2"></i> Guardar/Actualizar Contrato
                        </button>
                        <button type="button" class="btn btn-secondary ms-2" id="clear-contract-form-btn">
                            <i class="fas fa-eraser me-2"></i> Limpiar Formulario
                        </button>
                    </div>
                </form>
            </section>

            <section id="contract-list" class="content-section">
                <h2><i class="fas fa-list me-2"></i> Lista de Contratos</h2>
                <div class="filter-container">
                    <div class="filter-group">
                        <label for="filter-proveedor">N° Proveedor:</label>
                        <input type="text" id="filter-proveedor" class="form-control">
                    </div>
                    <div class="filter-group">
                        <label for="filter-sicac">N° SICAC:</label>
                        <input type="text" id="filter-sicac" class="form-control">
                    </div>
                    <div class="filter-buttons">
                        <button type="button" class="btn btn-primary" id="apply-filters-btn">Aplicar Filtros</button>
                        <button type="button" class="btn btn-secondary" id="clear-filters-btn">Limpiar Filtros</button>
                    </div>
                </div>
                
                <div class="export-buttons">
                    <button class="btn btn-info" id="export-excel-btn"><i class="fas fa-file-excel me-2"></i>Exportar Excel</button>
                    <button class="btn btn-danger" id="export-pdf-btn"><i class="fas fa-file-pdf me-2"></i>Exportar PDF</button>
                </div>

                <div class="table-responsive">
                    <table class="table table-hover contract-list-table" id="contract-list-table">
                        <thead>
                            <tr>
                                <th>N° Proveedor</th>
                                <th>N° SICAC</th>
                                <th>Fecha Inicio</th>
                                <th>Monto Total</th>
                                <th>Avance Físico</th>
                                <th>Avance Financiero</th>
                                <th>Estatus</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="contract-list-body">
                            </tbody>
                    </table>
                </div>
            </section>

            <section id="hes-management" class="content-section">
                <h2><i class="fas fa-clipboard-list me-2"></i> Gestión de HES</h2>
                <form id="hes-form" class="g-3">
                    <div class="row g-3 mb-4">
                        <div class="col-md-6">
                            <label for="hes-contract-select" class="form-label">Contrato Asociado:</label>
                            <select id="hes-contract-select" class="form-select" required>
                                <option value="">Seleccione un Contrato</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label for="hes-no-hes" class="form-label">No. HES:</label>
                            <input type="text" id="hes-no-hes" class="form-control" required>
                        </div>
                    </div>
                    
                    <div class="row g-3 mb-4">
                        <div class="col-md-4">
                            <label for="hes-fecha-inicio" class="form-label">Fecha Inicio HES:</label>
                            <input type="date" id="hes-fecha-inicio" class="form-control" required>
                        </div>
                        <div class="col-md-4">
                            <label for="hes-fecha-final" class="form-label">Fecha Final HES:</label>
                            <input type="date" id="hes-fecha-final" class="form-control" required>
                        </div>
                        <div class="col-md-4">
                            <label for="hes-fecha-creado" class="form-label">Fecha de Creado HES:</label>
                            <input type="date" id="hes-fecha-creado" class="form-control" readonly>
                        </div>
                    </div>

                    <div class="row g-3 mb-4">
                        <div class="col-md-6">
                            <label for="hes-aprobado" class="form-label">Aprobado:</label>
                            <select id="hes-aprobado" class="form-select">
                                <option value="Pendiente">Pendiente</option>
                                <option value="Aprobado">Aprobado</option>
                                <option value="Rechazado">Rechazado</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label for="hes-fecha-aprobado" class="form-label">Fecha Aprobado:</label>
                            <input type="date" id="hes-fecha-aprobado" class="form-control">
                        </div>
                    </div>

                    <div class="mb-4">
                        <label for="hes-texto-hes" class="form-label">Texto HES / Descripción:</label>
                        <textarea id="hes-texto-hes" class="form-control" rows="3"></textarea>
                    </div>

                    <div class="mb-4">
                        <label for="hes-texto-breve" class="form-label">Texto Breve:</label>
                        <input type="text" id="hes-texto-breve" class="form-control">
                    </div>

                    <div class="row g-3 mb-4">
                        <div class="col-md-4">
                            <label for="hes-valuacion" class="form-label">Valuación:</label>
                            <input type="number" id="hes-valuacion" class="form-control" step="0.01" value="0.00">
                        </div>
                        <div class="col-md-4">
                            <label for="hes-lugar-prestacion-servicio" class="form-label">Lugar de Prestación del Servicio:</label>
                            <input type="text" id="hes-lugar-prestacion-servicio" class="form-control">
                        </div>
                        <div class="col-md-4">
                            <label for="hes-responsable-sdo" class="form-label">Responsable SDO:</label>
                            <input type="text" id="hes-responsable-sdo" class="form-control">
                        </div>
                    </div>

                    <div class="mb-4">
                        <label for="hes-anexos" class="form-label">Anexos:</label>
                        <input type="file" id="hes-anexos" class="form-control" multiple>
                        <small class="text-muted" id="hes-anexos-info">Ningún archivo seleccionado</small>
                    </div>

                    <div class="row g-3 mb-4">
                        <div class="col-md-4 form-check form-switch d-flex align-items-center mb-3">
                            <input class="form-check-input me-2" type="checkbox" id="hes-ejecutada">
                            <label class="form-check-label" for="hes-ejecutada">Ejecutada</label>
                        </div>
                        <div class="col-md-4 form-check form-switch d-flex align-items-center mb-3">
                            <input class="form-check-input me-2" type="checkbox" id="hes-valuado">
                            <label class="form-check-label" for="hes-valuado">Valuado</label>
                        </div>
                    </div>

                    <h3 class="mt-4">Partidas de la HES (del Contrato Seleccionado)</h3>
                    <div class="alert alert-info" id="hes-partidas-info" role="alert">
                        Seleccione un contrato para cargar sus partidas.
                    </div>
                    <div class="table-responsive">
                        <table class="table table-bordered table-striped" id="hes-partidas-table">
                            <thead>
                                <tr>
                                    <th>N°</th>
                                    <th>Descripción de Contrato</th>
                                    <th>UMD</th>
                                    <th>Precio Unitario</th>
                                    <th>Cantidad Original Contrato</th>
                                    <th>Cantidad Ejecutada en otras HES</th>
                                    <th>Cantidad Disponible</th>
                                    <th>Cantidad a Ejecutar en esta HES</th>
                                    <th>Total Partida HES</th>
                                </tr>
                            </thead>
                            <tbody id="hes-partidas-table-body">
                                </tbody>
                        </table>
                    </div>

                    <div class="row g-3 mt-4">
                        <div class="col-md-4">
                            <label for="hes-subtotal" class="form-label">Sub Total HES:</label>
                            <input type="number" id="hes-subtotal" class="form-control" step="0.01" value="0.00" readonly>
                        </div>
                        <div class="col-md-4">
                            <label for="hes-gastos-administrativos" class="form-label">5% Gastos Administrativos:</label>
                            <input type="number" id="hes-gastos-administrativos" class="form-control" step="0.01" value="0.00" readonly>
                        </div>
                        <div class="col-md-4">
                            <label for="hes-total" class="form-label">Total HES:</label>
                            <input type="number" id="hes-total" class="form-control" step="0.01" value="0.00" readonly>
                        </div>
                    </div>

                    <div class="text-center mt-4 button-group">
                        <button type="submit" class="btn btn-primary" id="save-hes-btn">
                            <i class="fas fa-save me-2"></i> Guardar/Actualizar HES
                        </button>
                        <button type="button" class="btn btn-secondary ms-2" id="clear-hes-form-btn">
                            <i class="fas fa-eraser me-2"></i> Limpiar Formulario HES
                        </button>
                    </div>
                </form>

                <h3 class="mt-4">Lista de HES</h3>
                <div class="table-responsive">
                    <table class="table table-hover" id="hes-list-table">
                        <thead>
                            <tr>
                                <th>Contrato</th>
                                <th>No. HES</th>
                                <th>Fecha Inicio</th>
                                <th>Fecha Final</th>
                                <th>Total HES</th>
                                <th>Estatus</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="hes-list-body">
                            </tbody>
                    </table>
                </div>
            </section>

            <section id="physical-advance" class="content-section">
                <h2><i class="fas fa-chart-line me-2"></i> Avance Físico</h2>
                <p>Registra y sigue el progreso físico de tus contratos.</p>
                <div class="container mt-4">
                    <h3>Avance Físico por Contrato</h3>
                    <select id="physical-advance-contract-select" class="form-select mb-3">
                        <option value="">Seleccione un Contrato</option>
                    </select>
                    <div id="physical-advance-details" class="card p-3" style="display:none;">
                        <h5>Detalles del Contrato: <span id="pa-contract-sicac"></span></h5>
                        <p>Monto Total Contrato: <span id="pa-contract-total"></span></p>
                        <p>Avance Físico Global: <span id="pa-physical-global-percentage">0%</span></p>
                        <div class="progress mb-3">
                            <div id="pa-physical-global-progress-bar" class="progress-bar bg-info" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                        <h6 class="mt-4">Avance por Partida:</h6>
                        <div class="table-responsive">
                            <table class="table table-bordered table-striped">
                                <thead>
                                    <tr>
                                        <th>Descripción</th>
                                        <th>Cantidad Contrato</th>
                                        <th>Cantidad Ejecutada</th>
                                        <th>Avance (%)</th>
                                    </tr>
                                </thead>
                                <tbody id="pa-partidas-body">
                                    </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <section id="financial-advance" class="content-section">
                <h2><i class="fas fa-dollar-sign me-2"></i> Avance Financiero</h2>
                <p>Registra y sigue el progreso financiero de tus contratos.</p>
                <div class="container mt-4">
                    <h3>Avance Financiero por Contrato</h3>
                    <select id="financial-advance-contract-select" class="form-select mb-3">
                        <option value="">Seleccione un Contrato</option>
                    </select>
                    <div id="financial-advance-details" class="card p-3" style="display:none;">
                        <h5>Detalles del Contrato: <span id="fa-contract-sicac"></span></h5>
                        <p>Monto Total Contrato: <span id="fa-contract-total"></span></p>
                        <p>Monto Ejecutado en HES: <span id="fa-executed-amount"></span></p>
                        <p>Avance Financiero Global: <span id="fa-financial-global-percentage">0%</span></p>
                        <div class="progress mb-3">
                            <div id="fa-financial-global-progress-bar" class="progress-bar bg-success" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                        <h6 class="mt-4">Detalle de HES Asociadas:</h6>
                        <div class="table-responsive">
                            <table class="table table-bordered table-striped">
                                <thead>
                                    <tr>
                                        <th>No. HES</th>
                                        <th>Fecha Inicio HES</th>
                                        <th>Fecha Final HES</th>
                                        <th>Total HES</th>
                                        <th>Estatus HES</th>
                                    </tr>
                                </thead>
                                <tbody id="fa-hes-list-body">
                                    </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <section id="graphic-summary" class="content-section">
                <h2><i class="fas fa-chart-bar me-2"></i> Resumen Gráfico</h2>
                <p>Obtén visualizaciones claras del estado y distribución de tus contratos.</p>
                <div class="row mt-4">
                    <div class="col-md-6">
                        <div class="card p-3 mb-3">
                            <h5>Contratos por Estatus</h5>
                            <canvas id="contractStatusChart"></canvas>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card p-3 mb-3">
                            <h5>Contratos por Modalidad</h5>
                            <canvas id="contractModalityChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>

            <section id="reports" class="content-section">
                <h2><i class="fas fa-file-alt me-2"></i> Informes</h2>
                <p>Genera reportes personalizados para diferentes necesidades.</p>
                <div class="container mt-4">
                    <h3>Informe de Contrato Individual</h3>
                    <select id="report-contract-select" class="form-select mb-3">
                        <option value="">Seleccione un Contrato</option>
                    </select>
                    <div id="report-details" class="card p-3" style="display:none;">
                        <h5>Contrato: <span id="report-contract-sicac"></span></h5>
                        <p>Monto Total Contrato: <span id="report-contract-total"></span></p>
                        <p>Monto Consumido por HES: <span id="report-consumed-amount"></span></p>
                        <p>Monto Restante del Contrato: <span id="report-remaining-amount"></span></p>
                        
                        <h6 class="mt-4">Consumo de Partidas del Contrato:</h6>
                        <div class="table-responsive">
                            <table class="table table-bordered table-striped">
                                <thead>
                                    <tr>
                                        <th>Descripción</th>
                                        <th>Cantidad Original</th>
                                        <th>Cantidad Consumida</th>
                                        <th>Cantidad Restante</th>
                                        <th>Monto Consumido</th>
                                        <th>Monto Restante</th>
                                    </tr>
                                </thead>
                                <tbody id="report-partidas-consumo-body">
                                    </tbody>
                            </table>
                        </div>

                        <h6 class="mt-4">HES Asociadas a este Contrato:</h6>
                        <div class="table-responsive">
                            <table class="table table-bordered table-striped">
                                <thead>
                                    <tr>
                                        <th>No. HES</th>
                                        <th>Fecha Inicio</th>
                                        <th>Fecha Final</th>
                                        <th>Total HES</th>
                                        <th>Estatus</th>
                                    </tr>
                                </thead>
                                <tbody id="report-hes-list-body">
                                    </tbody>
                            </table>
                        </div>

                        <div class="mt-4 text-center">
                            <button class="btn btn-primary" id="generate-individual-report-pdf-btn">
                                <i class="fas fa-file-pdf me-2"></i> Generar PDF de Informe Individual
                            </button>
                        </div>
                    </div>

                    <h3 class="mt-4">Informe General de Contratos</h3>
                    <div class="text-center">
                        <button class="btn btn-primary" id="generate-general-report-pdf-btn">
                            <i class="fas fa-file-pdf me-2"></i> Generar PDF de Informe General
                        </button>
                    </div>
                </div>
            </section>

            <section id="trash-can" class="content-section">
                <h2><i class="fas fa-trash-alt me-2"></i> Papelera de Reciclaje</h2>
                <p>Aquí puedes restaurar o eliminar permanentemente los elementos borrados.</p>

                <h3 class="mt-4">Contratos Eliminados</h3>
                <div class="table-responsive mb-4">
                    <table class="table table-bordered table-striped">
                        <thead>
                            <tr>
                                <th><input type="checkbox" id="select-all-deleted-contracts"></th>
                                <th>N° Proveedor</th>
                                <th>N° SICAC</th>
                                <th>Fecha Eliminación</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="deleted-contracts-body">
                            </tbody>
                    </table>
                </div>
                <div class="text-end mb-4">
                    <button class="btn btn-success me-2" id="restore-selected-btn" data-type="contract"><i class="fas fa-undo me-2"></i> Restaurar Seleccionados</button>
                    <button class="btn btn-danger" id="delete-selected-permanent-btn" data-type="contract"><i class="fas fa-fire me-2"></i> Eliminar Seleccionados Permanentemente</button>
                </div>

                <h3 class="mt-4">HES Eliminadas</h3>
                <div class="table-responsive">
                    <table class="table table-bordered table-striped">
                        <thead>
                            <tr>
                                <th><input type="checkbox" id="select-all-deleted-hes"></th>
                                <th>Contrato ID</th>
                                <th>No. HES</th>
                                <th>Fecha Eliminación</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="deleted-hes-body">
                            </tbody>
                    </table>
                </div>
                <div class="text-end mt-4">
                    <button class="btn btn-success me-2" id="restore-selected-btn" data-type="hes"><i class="fas fa-undo me-2"></i> Restaurar Seleccionados</button>
                    <button class="btn btn-danger" id="delete-selected-permanent-btn" data-type="hes"><i class="fas fa-fire me-2"></i> Eliminar Seleccionados Permanentemente</button>
                </div>
            </section>
        </main>
    </div>

    <div class="modal fade" id="addEditModalidadModal" tabindex="-1" aria-labelledby="addEditModalidadModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addEditModalidadModalLabel">Gestionar Modalidades de Contratación</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="new-modalidad-input" class="form-label">Nueva Modalidad:</label>
                        <div class="input-group">
                            <input type="text" id="new-modalidad-input" class="form-control" placeholder="Ej: Obra, Servicio, Suministro">
                            <button class="btn btn-primary" type="button" id="add-modalidad-to-list-btn">Añadir</button>
                        </div>
                    </div>
                    <h6>Modalidades Existentes:</h6>
                    <ul class="list-group" id="modalidades-list">
                        </ul>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="main.js"></script>
</body>
</html>
